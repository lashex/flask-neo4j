# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

Flask-Neo4j is a Flask extension providing integration with Neo4j graph database via the official `neo4j` Python driver (v5.x). It supports direct and application factory initialization patterns.

## Commands

```bash
# Install dependencies
uv sync --extra dev              # Dev dependencies (testing, linting, type checking)
uv sync --extra docs             # Documentation dependencies

# Testing
uv run pytest -v -m "not integration"   # Unit tests only (mocked driver)
uv run pytest -v -m integration         # Integration tests (requires live Neo4j on localhost:7687)
uv run pytest -v                         # All tests

# Linting & formatting
uv run ruff check src/ tests/
uv run ruff format --check src/ tests/

# Type checking
uv run mypy src/

# Documentation
cd docs && uv run sphinx-build -b html . _build/html
```

## Architecture

Single-module extension in `src/flask_neo4j/extension.py` (~176 lines). The `Neo4j` class wraps `neo4j.GraphDatabase.driver()` and integrates with Flask's app context lifecycle.

**Key API surface:**
- `Neo4j(app)` or `Neo4j()` + `init_app(app)` — two init patterns
- `driver` property — underlying `neo4j.Driver`
- `session(**kwargs)` — opens session with configured database
- `execute(query, parameters)` — convenience for simple Cypher queries
- `close()` — teardown (also registered as app context teardown)

**Configuration:** 9 Flask config keys prefixed `NEO4J_` (URI, AUTH, DATABASE, connection pool, retry settings, pass-through driver config). Defaults defined in `_apply_driver_config()`.

**Testing:** Unit tests in `tests/test_extension.py` use `pytest-mock` to mock the Neo4j driver. Integration tests in `tests/test_integration.py` are marked with `@pytest.mark.integration` and need a running Neo4j instance.

## Git Commit Guidelines

Never include AI attribution (Co-Authored-By, "Generated by AI", etc.) in commit messages.
